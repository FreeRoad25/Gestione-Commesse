{% extends "layout.html" %}

{% block title %}Archivio Commesse Consegnate{% endblock %}

<style>
/* ============================
   FIX TABELLA ARCHIVIO STRETTA
   ============================ */

/* Contenitore scrollabile orizzontale */
.archivio-wrapper {
    width: 100%;
    overflow-x: auto;
    margin-top: 20px;
}

/* Tabella compatta */
.table-archivio {
    width: 100%;
    min-width: 950px; /* evita allargamenti pazzi */
    border-collapse: collapse !important;
}

/* Celle */
.table-archivio th,
.table-archivio td {
    padding: 5px 8px !important;
    font-size: 13px !important;
    height: 26px !important;
    line-height: 16px !important;
    color: #e0e0e0;
    vertical-align: middle !important;
    white-space: nowrap; /* impedisce righe alte */
}

/* Header */
.table-archivio th {
    background-color: #00bfff !important;
    color: #fff !important;
    font-weight: 600;
}

/* Righe alternate */
.table-archivio tr:nth-child(even) {
    background-color: #26283a !important;
}

/* Righe non saldate */
.riga-non-saldata {
    background-color: #7a1f1f !important;
}

/* Pulsante "Cambia" */
.table-archivio button {
    padding: 4px 10px;
    font-size: 12px;
}
</style>

{% block content %}
<div class="content-wrapper">
    <h1>üìÅ Archivio Commesse Consegnate</h1>

    <div class="archivio-wrapper">
        <table class="table-archivio">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Tipo Intervento</th>
                    <th>Data Conferma</th>
                    <th>Data Arrivo Materiali</th>
                    <th>Data Consegna</th>
                    <th>Ore Previste</th>
                    <th>Ore Lavorate</th>
                    <th>Saldata</th>
                    <th>Azione</th>
                </tr>
            </thead>

            <tbody>
                {% for c in commesse %}
                <tr class="{% if c.saldata == 'No' %}riga-non-saldata{% endif %}">
                    <td>{{ c.nome }}</td>
                    <td>{{ c.tipo_intervento }}</td>
                    <td>{{ c.data_conferma }}</td>
                    <td>{{ c.data_arrivo_materiali }}</td>
                    <td>{{ c.data_consegna }}</td>
                    <td>{{ c.ore_previste }}</td>
                    <td>{{ c.ore_lavorate }}</td>
                    <td>{{ c.saldata }}</td>

                    <td>
                        <form action="{{ url_for('toggle_saldata', id=c.id) }}" method="POST">
                            <button class="btn btn-sm btn-primary">Cambia</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}